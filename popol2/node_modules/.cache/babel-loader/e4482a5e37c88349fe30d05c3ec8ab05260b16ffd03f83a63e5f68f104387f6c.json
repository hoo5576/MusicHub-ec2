{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/user/Desktop/MusicHub-ec2/popol2/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/user/Desktop/MusicHub-ec2/popol2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/user/Desktop/MusicHub-ec2/popol2/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from'react';import{useEffect,useRef,useState}from\"react\";import{loadPaymentWidget}from\"@tosspayments/payment-widget-sdk\";import{useLocation}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var clientKey=\"test_gck_docs_Ovk5rk1EwkEbP0W43n07xlzm\";var customerKey=\"cF_qY0QYTa9_AQYoQ2Ede\";export function Payment(){var location=useLocation();var state=location.state;console.log(\"state:\",state);var paymentWidgetRef=useRef(null);var paymentMethodsWidgetRef=useRef(null);var _useState=useState(state.price),_useState2=_slicedToArray(_useState,2),price=_useState2[0],setPrice=_useState2[1];var _useState3=useState(state.name),_useState4=_slicedToArray(_useState3,2),name=_useState4[0],setName=_useState4[1];useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var paymentWidget,paymentMethodsWidget;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return loadPaymentWidget(clientKey,customerKey);case 2:paymentWidget=_context.sent;// 회원 결제\n// const paymentWidget = await loadPaymentWidget(clientKey, ANONYMOUS)  // 비회원 결제\n// ------  결제위젯 렌더링 ------\n// 결제수단 UI를 렌더링할 위치를 지정합니다. `#payment-method`와 같은 CSS 선택자와 결제 금액 객체를 추가하세요.\n// DOM이 생성된 이후에 렌더링 메서드를 호출하세요.\n// https://docs.tosspayments.com/reference/widget-sdk#renderpaymentmethods선택자-결제-금액-옵션\npaymentMethodsWidget=paymentWidget.renderPaymentMethods(\"#payment-widget\",{value:price},// 렌더링하고 싶은 멀티 결제 UI의 variantKey\n// https://docs.tosspayments.com/guides/payment-widget/admin#멀티-결제-ui\n{variantKey:\"DEFAULT\"});// ------  이용약관 렌더링 ------\n// 이용약관 UI를 렌더링할 위치를 지정합니다. `#agreement`와 같은 CSS 선택자를 추가하세요.\n// https://docs.tosspayments.com/reference/widget-sdk#renderagreement선택자-옵션\npaymentWidget.renderAgreement('#agreement',{variantKey:\"AGREEMENT\"}// 기본 이용약관 렌더링\n);paymentWidgetRef.current=paymentWidget;paymentMethodsWidgetRef.current=paymentMethodsWidget;case 7:case\"end\":return _context.stop();}},_callee);}))();},[]);useEffect(function(){var paymentMethodsWidget=paymentMethodsWidgetRef.current;if(paymentMethodsWidget==null){return;}// ------ 금액 업데이트 ------\n// 새로운 결제 금액을 넣어주세요.\n// https://docs.tosspayments.com/reference/widget-sdk#updateamount결제-금액\npaymentMethodsWidget.updateAmount(price,paymentMethodsWidget.UPDATE_REASON.COUPON);},[price]);return/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'50px',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"h1\",{children:name}),/*#__PURE__*/_jsx(\"span\",{children:\"\".concat(price.toLocaleString(),\"\\uC6D0\")}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'20px',textAlign:'center'},children:/*#__PURE__*/_jsxs(\"label\",{style:{textAlign:'center'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",onChange:function onChange(event){setPrice(event.target.checked?price-500:price+500);}}),\"500\\uC6D0 \\uD560\\uC778 \\uCFE0\\uD3F0 \\uC801\\uC6A9\"]})}),/*#__PURE__*/_jsx(\"div\",{id:\"payment-widget\"}),/*#__PURE__*/_jsx(\"div\",{id:\"agreement\"}),/*#__PURE__*/_jsx(\"button\",{onClick:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var paymentWidget;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:paymentWidget=paymentWidgetRef.current;_context2.prev=1;_context2.next=4;return paymentWidget===null||paymentWidget===void 0?void 0:paymentWidget.requestPayment({orderId:\"GEc_JImf1o6lzPPcYT1r6\",orderName:\"Music Hub\",customerName:\"사용자\",successUrl:\"\".concat(window.location.origin,\"/success\"),failUrl:\"\".concat(window.location.origin,\"/fail\")});case 4:_context2.next=9;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](1);// 에러 처리하기\nconsole.error(_context2.t0);case 9:case\"end\":return _context2.stop();}},_callee2,null,[[1,6]]);})),children:\"\\uACB0\\uC81C\\uD558\\uAE30\"})]});}export default Payment;","map":{"version":3,"names":["React","useEffect","useRef","useState","loadPaymentWidget","useLocation","jsx","_jsx","jsxs","_jsxs","clientKey","customerKey","Payment","location","state","console","log","paymentWidgetRef","paymentMethodsWidgetRef","_useState","price","_useState2","_slicedToArray","setPrice","_useState3","name","_useState4","setName","_asyncToGenerator","_regeneratorRuntime","mark","_callee","paymentWidget","paymentMethodsWidget","wrap","_callee$","_context","prev","next","sent","renderPaymentMethods","value","variantKey","renderAgreement","current","stop","updateAmount","UPDATE_REASON","COUPON","style","marginTop","textAlign","children","concat","toLocaleString","type","onChange","event","target","checked","id","onClick","_callee2","_callee2$","_context2","requestPayment","orderId","orderName","customerName","successUrl","window","origin","failUrl","t0","error"],"sources":["C:/Users/user/Desktop/MusicHub-ec2/popol2/src/routes/Payment.tsx"],"sourcesContent":["import React from 'react';\r\nimport { useEffect, useRef, useState } from \"react\"\r\nimport {\r\n  PaymentWidgetInstance,\r\n  loadPaymentWidget,\r\n  ANONYMOUS,\r\n} from \"@tosspayments/payment-widget-sdk\"\r\nimport { useParams, useLocation } from 'react-router-dom';\r\n\r\nconst clientKey = \"test_gck_docs_Ovk5rk1EwkEbP0W43n07xlzm\"\r\nconst customerKey = \"cF_qY0QYTa9_AQYoQ2Ede\"\r\n\r\nexport function Payment() {\r\n  const location = useLocation();\r\n  const { state } = location;\r\n  console.log(\"state:\", state);\r\n\r\n\r\n  const paymentWidgetRef = useRef<PaymentWidgetInstance | null>(null)\r\n  const paymentMethodsWidgetRef = useRef<ReturnType<\r\n    PaymentWidgetInstance[\"renderPaymentMethods\"]\r\n  > | null>(null)\r\n  const [price, setPrice] = useState(state.price)\r\n  const [name, setName] = useState(state.name)\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      // ------  결제위젯 초기화 ------\r\n      // 비회원 결제에는 customerKey 대신 ANONYMOUS를 사용하세요.\r\n      const paymentWidget = await loadPaymentWidget(clientKey, customerKey)  // 회원 결제\r\n      // const paymentWidget = await loadPaymentWidget(clientKey, ANONYMOUS)  // 비회원 결제\r\n\r\n      // ------  결제위젯 렌더링 ------\r\n      // 결제수단 UI를 렌더링할 위치를 지정합니다. `#payment-method`와 같은 CSS 선택자와 결제 금액 객체를 추가하세요.\r\n      // DOM이 생성된 이후에 렌더링 메서드를 호출하세요.\r\n      // https://docs.tosspayments.com/reference/widget-sdk#renderpaymentmethods선택자-결제-금액-옵션\r\n      const paymentMethodsWidget = paymentWidget.renderPaymentMethods(\r\n        \"#payment-widget\",\r\n        { value: price },\r\n        // 렌더링하고 싶은 멀티 결제 UI의 variantKey\r\n        // https://docs.tosspayments.com/guides/payment-widget/admin#멀티-결제-ui\r\n        { variantKey: \"DEFAULT\" }\r\n      )\r\n\r\n      // ------  이용약관 렌더링 ------\r\n      // 이용약관 UI를 렌더링할 위치를 지정합니다. `#agreement`와 같은 CSS 선택자를 추가하세요.\r\n      // https://docs.tosspayments.com/reference/widget-sdk#renderagreement선택자-옵션\r\n      paymentWidget.renderAgreement(\r\n        '#agreement',\r\n        { variantKey: \"AGREEMENT\" } // 기본 이용약관 렌더링\r\n      )\r\n      paymentWidgetRef.current = paymentWidget\r\n      paymentMethodsWidgetRef.current = paymentMethodsWidget\r\n    })()\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    const paymentMethodsWidget = paymentMethodsWidgetRef.current\r\n\r\n    if (paymentMethodsWidget == null) {\r\n      return\r\n    }\r\n\r\n    // ------ 금액 업데이트 ------\r\n    // 새로운 결제 금액을 넣어주세요.\r\n    // https://docs.tosspayments.com/reference/widget-sdk#updateamount결제-금액\r\n    paymentMethodsWidget.updateAmount(\r\n      price,\r\n      paymentMethodsWidget.UPDATE_REASON.COUPON\r\n    )\r\n  }, [price])\r\n\r\n  return (\r\n    <div style={{ marginTop: '50px', textAlign: 'center' }}>\r\n      <h1>{name}</h1>\r\n      <span>{`${price.toLocaleString()}원`}</span>\r\n      <div style={{ marginTop: '20px', textAlign: 'center' }}>\r\n        <label style={{ textAlign: 'center' }}>\r\n          <input\r\n            type=\"checkbox\"\r\n            onChange={(event) => {\r\n              setPrice(event.target.checked ? price - 500 : price + 500)\r\n            }}\r\n          />\r\n          500원 할인 쿠폰 적용\r\n        </label>\r\n      </div>\r\n      <div id=\"payment-widget\" />\r\n      <div id=\"agreement\" />\r\n      <button\r\n        onClick={async () => {\r\n          const paymentWidget = paymentWidgetRef.current\r\n\r\n          try {\r\n            // ------ '결제하기' 버튼 누르면 결제창 띄우기 ------\r\n            // 더 많은 결제 정보 파라미터는 결제위젯 SDK에서 확인하세요.\r\n            // https://docs.tosspayments.com/reference/widget-sdk#requestpayment결제-정보\r\n            await paymentWidget?.requestPayment({\r\n              orderId: \"GEc_JImf1o6lzPPcYT1r6\",\r\n              orderName: \"Music Hub\",\r\n              customerName: \"사용자\",\r\n              successUrl: `${window.location.origin}/success`,\r\n              failUrl: `${window.location.origin}/fail`,\r\n            })\r\n          } catch (error) {\r\n            // 에러 처리하기\r\n            console.error(error)\r\n          }\r\n        }}\r\n      >\r\n        결제하기\r\n      </button>\r\n    </div>\r\n  )\r\n}\r\nexport default Payment;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}